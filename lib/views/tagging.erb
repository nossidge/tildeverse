<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"></meta>
    <title>Tildeverse Tags</title>
    <script src="https://tilde.town/~nossidge/jquery/src/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://tilde.town/~nossidge/zelda/holy_grail.css">
    <link rel="stylesheet" href="browser/browser.css">
    <script src="browser/browser.js"></script>
    <script language="javascript">

      $(document).ready( function() {

        // Wait for the external JSON file to load.
        $.getJSON("tildeverse.json", function(data) {

          // Load the JSON data to the USERS module.
          USERS.initialize(data);

          // By default, filter for only newly updated users.
          TOGGLE_GROUPS.toggleNewlyUpdated();

          // Navigate to a random URL.
          URL_NAVIGATION.randomUrl();

        });

      });

    </script>
    <style type="text/css">
      .col_left {
        flex: 0 0 223px;
      }
      #tag_area_top {
        margin: 0px 0px 3px 0px;
      }
      #save {
        margin: 0px -1px 0px 0px;
        width: 88px;
      }
      .tag_button_desc {
        pointer-events: auto;
      }
    </style>
  </head>
  <body class="border">
    <header class="border">
      <div class="header_div">
        <div class="header_title input-group-lg">
          <input id="text_user"
                 type="text"
                 class="form-control"
                 readonly="readonly"
                 onfocus="this.focus();this.select()"
          />
          <a hidden id="url_iframe_link" target="tildesite"></a>
          <a hidden id="url_blank_link" target="_blank"></a>
        </div>
        <div class="header_left">
          <div class="btn-group btn-group-lg">
            <a class="btn btn-default top_button"
                title="Previous user"
                onclick="URL_NAVIGATION.previousUrl()">
              <span class="glyphicon glyphicon-arrow-left"></span>
            </a>
            <a class="btn btn-default top_button"
                title="Next user"
                onclick="URL_NAVIGATION.nextUrl()">
              <span class="glyphicon glyphicon-arrow-right"></span>
            </a>
            <a class="btn btn-default top_button"
                title="Random user"
                onclick="URL_NAVIGATION.randomUrl()">
              <span class="glyphicon glyphicon-random"></span>
            </a>
          </div>
          <a class="btn btn-default top_button btn-lg"
              title="Open user homepage in new tab"
              onclick="USERS.openCurrentInNewTab()">
            <span class="glyphicon glyphicon-eye-open"></span>
          </a>
        </div>
        <div class="header_right">
          <select id="url_dropdown"
                  class="form-control input-lg"
                  onchange="URL_NAVIGATION.gotoUrlIndex(this.value)">
          </select>
          <input id="text_counter"
                 type="text"
                 class="form-control input-lg"
                 readonly="readonly"
                 onfocus="this.focus();this.select()"
          />
        </div>
      </div>
    </header>
    <div class="contents">
      <div id="col_left" class="col_left border">
        <div id="col_left_content">
          <div id="tag_area">
            <div id="tag_area_left">
              <div id="tag_area_top" class="btn-block">
                <div class="btn-group">
                  <a id="filter_by_never_tagged" title="Filter for users who have never been tagged"
                      class="btn btn-default btn-lg btn_tags" onclick="TOGGLE_GROUPS.toggleNeverTagged()">
                    <span class="glyphicon glyphicon-inbox"></span>
                  </a>
                  <a id="filter_by_newly_updated" title="Filter for users who have modified their pages since last being tagged"
                      class="btn btn-default btn-lg btn_tags" onclick="TOGGLE_GROUPS.toggleNewlyUpdated()">
                    <span class="glyphicon glyphicon-time"></span>
                  </a>
                </div>
                <a id="save" title="Save changes to user tags"
                    class="btn btn-default btn-lg btn_tags" onclick="TAG_STATE.saveTagsToFile()">
                  <span id="save_glyphicon" class="glyphicon glyphicon-floppy-saved"></span>
                </a>
              </div>
              <div id="tag_buttons" class="btn-group-vertical btn-block">
                <% @tags.each do |tag| %>
                  <a id="tag_button_<%= tag %>"
                      class="btn btn-default btn-lg btn_tags tag_button_desc"
                      data-tag-name="<%= tag %>"
                      onclick="TAG_STATE.toggleTag(this);">
                    <%= tag %>
                  </a>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
      <iframe id="col_middle" class="col_middle border" name="tildesite"></iframe>
    </div>
  </body>
</html>
